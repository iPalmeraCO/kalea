<?php
/**
 * Copyright © Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile
/** @var \Magento\Contact\Block\ContactForm $block */
?>
  <style>
    img.log-modal {
    height: 45px;
    text-align: center;
    margin-bottom: 20px;
    margin-top: 20px;
  }
  .header {
    text-align: center;
}
.modal-body {
    text-align: center;
}
.che {
    text-align: center;
    color: #2f3033;
    font-size: 25px;
    text-transform: uppercase;
    font-weight: 300;
        font-family: 'Roboto Condensed', sans-serif;
        margin-top: 25px;
}
.modal-footer {
    text-align: center;
    display: flex;
    border: 0;
    justify-content: center;
    padding: 0;
    margin-bottom: 30px;
}
button.btn.otro-btn {
    background-color: #751e7f;
    padding: 8px 30px;
    border-radius: 8px;
    font-family: 'Heebo', sans-serif;
    font-weight: 300;
    color: #ffffff;
    box-shadow: none !important;
    font-size: 14px;
    position: relative;
    margin-right: 0px;
    width: 150px;
}
  </style>

<form class="form-contact"
      action="<?= $block->escapeUrl($block->getFormAction()) ?>"
      id="contact-form"
      method="post"
      data-hasrequired="<?= $block->escapeHtmlAttr(__('* Required Fields')) ?>"
      data-mage-init='{"validation":{}}'>
      <div class="form-row">
    <!-- <fieldset class="fieldset"> -->

        	<div class="form-group col-sm-12 col-md-12 col-lg-6">
                <input placeholder="Nombre *" name="name" id="name" title="<?= $block->escapeHtmlAttr(__('Nombre')) ?>" value="<?= $block->escapeHtmlAttr($this->helper('Magento\Contact\Helper\Data')->getPostValue('name') ?: $this->helper('Magento\Contact\Helper\Data')->getUserName()) ?>" class="input-text inpre" type="text" data-validate="{required:true}"/>
            
            </div>
        
        <div class="form-group col-sm-12 col-md-12 col-lg-6">
        <!-- <div class="field email required"> -->
           
                <input placeholder="Correo *" name="email" id="email" title="<?= $block->escapeHtmlAttr(__('Correo')) ?>" value="<?= $block->escapeHtmlAttr($this->helper('Magento\Contact\Helper\Data')->getPostValue('email') ?: $this->helper('Magento\Contact\Helper\Data')->getUserEmail()) ?>" class="input-text inpre" type="email" data-validate="{required:true, 'validate-email':true}"/>
            
        <!-- </div> -->
        </div>
        </div>
         <div class="form-group telephone">
        <!-- <div class="field telephone"> -->
            
            <!-- <div class="control"> -->
                <input placeholder ="Número de factura (si aplica)" name="telephone" id="telephone" title="<?= $block->escapeHtmlAttr(__('Número de factura(si aplica)')) ?>" value="<?= $block->escapeHtmlAttr($this->helper('Magento\Contact\Helper\Data')->getPostValue('telephone')) ?>" class="input-text" type="text" />
            <!-- </div> -->
        <!-- </div> -->
        </div>
        <div class="form-group subject required">
		    
		    <!-- <div class="control"> -->
		        <input placeholder="Asunto" name="subject" id="subject" title="<?php /* @escapeNotVerified */ echo __('Asunto') ?>" value="" class="input-text inpre" type="text" data-validate="{required:true}"/>
		    <!-- </div> -->
		</div>
        <div class="form-group comment required">
            
            <!-- <div class="control"> -->
                <textarea placeholder="Mensaje *" name="comment" id="comment" title="<?= $block->escapeHtmlAttr(__('Mensaje')) ?>" class="input-text inpre" cols="5" rows="3" data-validate="{required:true}"><?= $block->escapeHtml($this->helper('Magento\Contact\Helper\Data')->getPostValue('comment')) ?></textarea>
            <!-- </div> -->
        </div>
        <?= $block->getChildHtml('form.additional.info') ?>
    <!-- </fieldset> -->
    <div class="actions-toolbar right-button">
        <div class="primary">
            <input type="hidden" name="hideit" id="hideit" value="" />
            <button type="submit" title="<?= $block->escapeHtmlAttr(__('Enviar')) ?>" class="btn btn-enviar">
                <span><?= $block->escapeHtml(__('ENVIAR')) ?></span>
                 <i class="far fa-paper-plane"></i>
            </button>
        </div>
    </div>

</form>



<div class="modal" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display:none">
  <div class="modal-dialog " role="document">
    <div class="modal-content">
      <div class="header" style="padding:0;">
        <div class="line" style="width: 100%; height: 22px; background: #000;"></div>
        <img src="img/logo.svg" alt="" class="log-modal">
       <!--  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button> -->
        <div class="line" style="width: 90%; height: 1px;
        margin: auto; background: #95a2aa;"></div>
      </div>
      <div class="modal-body">
        <img src="img/aprobado.png" alt="">
        <h4 class="che">SE ENVÍO CORRECTAMENTE</h4>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn otro-btn" data-dismiss="modal" onclick="jQuery('#exampleModalCenter').modal('closeModal');">Cerrar</button>
      </div>
      <img src="img/lineas.jpg" alt="">
    </div>
  </div>
</div>


<script type="text/javascript">

    require(
        [
            'jquery',
            'Magento_Ui/js/modal/modal'
        ],
        function(
            $,
            modal
        ) {
            var options = {
                'type': 'popup',
                
                'modalClass': 'your_popup_custom_class',
                'responsive': true,
                'innerScroll': true,
                'buttons': [{
                    text: $.mage.__('Aceptar'),
                    class: 'back_button_class',
                    click: function () {
                        this.closeModal();
                        // any javascript coode
                    }
                }]
            };

            $(document).ready(function(){
                var popup = modal(options, $('#exampleModalCenter'));  

               
                //$("#exampleModalCenter").modal("openModal");                 
            });
        }
    );

</script>


<script type="text/javascript">
  require(['jquery','Magento_Ui/js/modal/modal'],function($){      
    
	$("#contact-form").submit(function(e) {
		e.preventDefault(); // avoid to execute the actual submit of the form.
		if (validarform() == 1){
		    var form = $(this);
		    var url = form.attr('action');

		    $.ajax({
		           type: "POST",
		           url: url,
		           data: form.serialize(), // serializes the form's elements.
		           success: function(data)
		           {
		           		if (data == 1){		           			
                    $("#exampleModalCenter").modal("openModal");
		           			$("#contact-form")[0].reset();
		           		}else{
		           			alert(data); // show response from the php script.	
		           		}
		               
		               
		           }
		         });
			}

    	
});

 
	function validarform(){
		var valid = -1;
		var cont = 0;
		$( ".inpre" ).each(function() {
			if ($(this).val() != ""){
				cont= cont + 1;
				$(this).css("border","1px solid green");
			} else {
				$(this).css("border","1px solid red");
			}		  
		});
		if ($(".inpre").length == cont ){
			valid = 1;
		}
		if (!isValidEmailAddress($("#email").val())){
			$("#email").css("border","1px solid red");
			valid = -1;		}

		
		return valid;
	}

	 function isValidEmailAddress(emailAddress) {
    var pattern = new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);
    return pattern.test(emailAddress);
	}
	});
</script>
